# 第二章 数据的表示与运算

> 本章对应课件：`计算机组成原理2.1.pdf`、`计算机组成原理2.2.pdf`

## 一、章节概述

本章深入研究计算机内部如何表示数值、字符等数据，以及如何执行基本算术运算。这是理解计算机工作原理的基础，也是后续学习CPU设计、ALU实现的关键前置知识。

## 二、学习目标

1. **掌握数制转换方法**
   - 熟练掌握二进制、八进制、十进制、十六进制之间的转换
   - 理解为何计算机选用二进制系统

2. **理解定点数表示**
   - 掌握原码、反码、补码的表示规则与特性
   - 理解补码的设计思想及其在运算中的优势

3. **理解浮点数表示**
   - 掌握IEEE 754浮点数标准（单精度、双精度）
   - 理解规格化、阶码、尾数等概念
   - 掌握浮点数的运算方法及精度损失问题

4. **掌握定点数运算**
   - 能设计简单的加法器、减法器电路
   - 理解乘法器和除法器的基本实现方式
   - 掌握溢出检测方法

5. **了解字符编码**
   - 熟悉ASCII、Unicode等字符编码标准

## 三、核心内容详解

### 2.1 数据的表示

#### 1. 数制与转换

**常用数制**：
- 二进制（Base-2）：逢二进一，使用数字0、1
- 八进制（Base-8）：使用数字0-7，常用于简化二进制表示
- 十进制（Base-10）：日常使用的数制
- 十六进制（Base-16）：使用0-9、A-F，简洁表示二进制

**转换技巧**：
- 十进制→二进制：除2取余法（整数）、乘2取整法（小数）
- 二进制→十进制：按权展开法
- 二进制↔八进制/十六进制：分组转换法（3位/4位一组）

**示例**：
```
十进制 25 → 二进制：
25 ÷ 2 = 12 余 1
12 ÷ 2 = 6  余 0
6  ÷ 2 = 3  余 0
3  ÷ 2 = 1  余 1
1  ÷ 2 = 0  余 1
结果：11001 (从下往上读)
```

#### 2. 定点数表示

**机器数与真值**：
- 机器数：数据在计算机中的二进制表示形式（包含符号位）
- 真值：机器数对应的实际数值

**三种编码方式**：

| 编码 | 符号位规则 | 数值位规则 | 零的表示 | 特点 |
|------|------------|------------|----------|------|
| 原码 | 0正1负 | 绝对值的二进制 | +0和-0两种 | 直观但运算复杂 |
| 反码 | 0正1负 | 负数数值位取反 | +0和-0两种 | 过渡形式 |
| 补码 | 0正1负 | 负数反码+1 | 唯一的0 | 便于运算 |

**补码的优势**：
1. 加法和减法统一为加法运算
2. 零的表示唯一
3. 可以多表示一个负数（-2^(n-1)）

**示例**（8位机器数）：
```
+5: 原码 = 00000101, 反码 = 00000101, 补码 = 00000101
-5: 原码 = 10000101, 反码 = 11111010, 补码 = 11111011
```

#### 3. 浮点数表示（IEEE 754标准）

**格式**：
- **符号位（S）**：1位，0表示正，1表示负
- **阶码（E）**：8位（单精度）/11位（双精度），使用移码表示
- **尾数（M）**：23位（单精度）/52位（双精度），使用原码表示

**单精度浮点数（32位）**：
```
S | EEEEEEEE | MMMMMMMMMMMMMMMMMMMMMMM
1    8位         23位
```

**规格化**：
- 尾数隐藏最高位的1，即实际尾数为1.M
- 阶码采用偏移量表示（单精度偏移127，双精度偏移1023）

**示例**：表示-12.5
```
1. 转二进制：12.5 = 1100.1
2. 规格化：1100.1 = 1.1001 × 2³
3. 符号位：S = 1（负数）
4. 阶码：E = 3 + 127 = 130 = 10000010
5. 尾数：M = 1001... (隐藏了前导1)
结果：1 10000010 10010000000000000000000
```

**特殊值**：
- 0：阶码和尾数全为0
- ∞：阶码全1，尾数全0
- NaN：阶码全1，尾数非0

#### 4. 字符编码

- **ASCII**：7位编码，表示128个字符（包括控制字符和可打印字符）
- **Unicode**：支持全球所有语言字符
  - UTF-8：变长编码，兼容ASCII
  - UTF-16：使用2或4字节
  - UTF-32：固定4字节

### 2.2 定点数的运算

#### 1. 定点加减运算

**补码加法规则**：
- 符号位与数值位一起参与运算
- 结果自动为补码形式
- 溢出判断：双符号位法或参与最高位进位

**示例**：+5 + (-3)
```
[+5]补 = 00000101
[-3]补 = 11111101
相加   = 00000010 = +2 ✓
```

**减法转加法**：
- A - B = A + (-B)
- 即对B求补码（变号），然后与A相加

**溢出判断**：
- **方法1**：双符号位法（变形补码）
  - 00：正常正数
  - 11：正常负数
  - 01：负溢出
  - 10：正溢出

- **方法2**：单符号位法
  - 最高位进位C_n与符号位进位C_(n-1)异或
  - V = C_n ⊕ C_(n-1)

#### 2. 定点乘法运算

**原码一位乘法**：
- 符号位单独处理（异或得符号）
- 数值部分相乘
- 部分积累加

**补码乘法（Booth算法）**：
- 从低位到高位扫描乘数
- 根据相邻位差异决定操作（加、减或移位）
- 优点：正负数统一处理

#### 3. 定点除法运算

**原码除法（恢复余数法）**：
1. 比较除数与被除数/余数
2. 够减则商1，继续；不够减则商0，恢复余数

**补码除法（加减交替法）**：
- 利用补码性质，简化符号处理

#### 4. 算术逻辑单元（ALU）

ALU是CPU中执行算术和逻辑运算的核心部件。

**基本功能**：
- 算术运算：加、减、乘、除、增1、减1
- 逻辑运算：与、或、非、异或
- 移位操作：逻辑移位、算术移位、循环移位

**设计要素**：
- 多功能：一个ALU支持多种操作
- 功能选择：通过控制信号选择不同功能
- 标志位：零标志(Z)、进位标志(C)、溢出标志(V)、符号标志(S)

**简单ALU结构**：
```
输入：A, B（操作数）
控制：F（功能选择码）
输出：Result, Flags（结果和标志位）
```

## 四、重点难点

### 重点
1. 补码的表示与运算规则
2. IEEE 754浮点数格式
3. 定点加减运算及溢出判断
4. ALU的基本功能

### 难点
1. 补码运算的溢出检测机制
2. 浮点数的规格化与阶码调整
3. Booth乘法算法的原理
4. 加减交替除法的实现

## 五、教学建议

1. **实例驱动**：通过大量实例演示各种数制转换与运算过程
2. **对比学习**：对比原码、反码、补码的优劣
3. **软件模拟**：使用Logisim设计简单的加法器、ALU
4. **习题训练**：安排足够的练习题巩固运算规则

## 六、课后练习

1. **数制转换**：
   - 将十进制数156转换为二进制、八进制、十六进制
   - 将二进制数10110.101转换为十进制

2. **定点数表示**：
   - 用8位二进制分别表示+25和-25的原码、反码、补码

3. **补码运算**：
   - 计算补码：[+15] + [-20]
   - 判断是否溢出

4. **浮点数表示**：
   - 用IEEE 754单精度格式表示-6.5

5. **设计题**：
   - 设计一个4位补码加法器，画出逻辑电路图

## 七、延伸阅读

- IEEE 754浮点数标准详细文档
- David Goldberg: "What Every Computer Scientist Should Know About Floating-Point Arithmetic"
- 《数字逻辑与计算机组成》相关章节

---

> **总结**：本章是计算机组成原理的核心基础，务必熟练掌握数据表示与运算的各个知识点。
